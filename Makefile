#===============================================================================
# User Options
#===============================================================================

PROGRAM  = 3DKBA
CC       = icpc
DEBUG    = no
OPTIMIZE = yes
PROFILE  = no

#===============================================================================
# Object Files
#===============================================================================

OBJECTS = main.o auxiliary_function.o miniapp.o                 

#===============================================================================
# COMPILER FLAGS
#===============================================================================

ifeq ($(CC), icpc)
	CCFLAGS += -openmp
else
	CCFLAGS += -fopenmp
endif

ifeq ($(OPTIMIZE),yes)
  CCFLAGS += -O3
else
  CCFLAGS += -O0
endif

ifeq ($(DEBUG),yes)
  CCFLAGS += -g
endif

#===============================================================================
# Targets
#===============================================================================

$(PROGRAM): $(OBJECTS)
	$(CC) $(OBJECTS) -o $@ $(CCFLAGS) $(LDFLAGS) $(LIB) $(INCLUDE)

clean:
	@rm -f *.o $(PROGRAM)

neat:
	@rm -f *.o

#===============================================================================
# Rules
#===============================================================================

.SUFFIXES: .cc .o
.PHONY: clean neat

%.o: %.cc
	$(CC) $(CCFLAGS) $(INCLUDE) -c $<

#===============================================================================
# Dependencies
#===============================================================================

main.o: auxiliary_function.o
main.o: miniapp.o

miniapp.o: auxiliary_function.o

